<!DOCTYPE html>
    <head>
        <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script src="clarifaiRequest.js"></script>
        <script>
        var data;
        var selfImageList = [];
        var str = location.hash;
        str = str.substring(14, str.length);
        $.ajax({
            type: "GET",
            dataType: "jsonp",
            cache: false,
            url: "https://api.instagram.com/v1/users/self/media/recent/?client_id=b3ff009db8c3416e87f3b1625a475294&access_token="+str,
            success: function(data) {
                data = data;
                for(var i = 0; i < data['data'].length; i++){
                    selfImageList.push(data['data']['images']['standard_resolution']);
                }
                console.log(selfImageList);
            }
        });
        </script>
        <script>
        function getAccessToken() {
            var formData = {
                grant_type: "client_credentials",
                client_id: "XqUKUx-7b5Y1TIXChj8yhXGdcRldG5t7wzJWTtH8",
                client_secret: "a5rz9I8_aJnJqh6EUn1nNponqSVjZiuOPSrmsCE3",
                };
            jQuery.ajax({
                url: "https://api.clarifai.com/v1/token/",
                type: "POST",
                data: formData,
                async: false,
                success: function(data, textStatus, jqXHR) {
                    // do stuff with data
                    console.log(data['access_token']);
                    imageRequest("http://i.imgur.com/ECAKUzG.jpg", data["access_token"]);

                },
                error: function(jqXHR, textStatus, errorThrown) {
                    // do stuff with error
                }
            });
        }

        function imageRequest(photoUrl, token) {
            jQuery.ajax({
                url: "https://api.clarifai.com/v1/tag/",
                type: "post",
                beforeSend: function(xhr) {
                    console.log('Bearer'.concat(token))
                    xhr.setRequestHeader('Authorization', 'Bearer '.concat(token));
                },
                data: {
                    url: photoUrl,
                },
                dataType: 'json',
                async: false,
                success: function(data) {
                    console.log(data);
                },
                error: function(jqXHR, textStatus, errorThrow) {
                    console.log(errorThrow);
                }
            })
        }

        getAccessToken();
        </script>
    </head>
    <body>
        <p>Hi there!</p>
        <p id='access_token'></p>
        <a href="https://instagram.com/oauth/authorize/?client_id=b3ff009db8c3416e87f3b1625a475294&redirect_uri=http://compatigram.herokuapp.com&response_type=token">Click here!</a>
    </body>
</html>
